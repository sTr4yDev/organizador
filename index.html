<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizador de Tareas - Electron + MySQL</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header Mejorado con Estado de BD -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-title">
                    <h1>ğŸ“‹ Organizador de Tareas</h1>
                    <p class="subtitle">Electron + MySQL - CRUD, Triggers & Transacciones</p>
                </div>
                <div class="header-status" id="database-status">
                    <div class="status-indicator connecting">
                        <div class="status-dot"></div>
                        <span>Conectando a MySQL...</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Menu Mejorado -->
        <nav class="main-nav">
            <div class="nav-container">
                <button class="menu-btn active" data-section="tasks">
                    <span class="menu-icon">ğŸ“</span>
                    <span class="menu-text">Tareas</span>
                    <span class="menu-badge" id="tasks-count">0</span>
                </button>
                <button class="menu-btn" data-section="categories">
                    <span class="menu-icon">ğŸ·ï¸</span>
                    <span class="menu-text">CategorÃ­as</span>
                    <span class="menu-badge" id="categories-count">0</span>
                </button>
                <button class="menu-btn" data-section="audit">
                    <span class="menu-icon">ğŸ“Š</span>
                    <span class="menu-text">AuditorÃ­a</span>
                    <span class="menu-badge" id="audit-count">0</span>
                </button>
                <button class="menu-btn" data-section="demo">
                    <span class="menu-icon">âš¡</span>
                    <span class="menu-text">Demo SQL</span>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- ========== SECCIÃ“N TAREAS MEJORADA ========== -->
            <section id="section-tasks" class="content-section active">
                <div class="section-header">
                    <h2>ğŸ¯ GestiÃ³n de Tareas</h2>
                    <p>CRUD completo con triggers automÃ¡ticos en MySQL</p>
                </div>

                <div class="content-grid">
                    <!-- Formulario Tareas -->
                    <div class="form-container card">
                        <form id="task-form" class="task-form">
                            <h3 id="form-title">â• Nueva Tarea</h3>
                            <input type="hidden" id="task-id">
                            
                            <div class="form-group">
                                <label for="task-title">TÃ­tulo *</label>
                                <input type="text" id="task-title" placeholder="Â¿QuÃ© necesitas hacer?" required>
                            </div>

                            <div class="form-group">
                                <label for="task-description">DescripciÃ³n</label>
                                <textarea id="task-description" placeholder="Detalles de la tarea..." rows="3"></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="task-category">CategorÃ­a</label>
                                    <select id="task-category">
                                        <option value="">Sin categorÃ­a</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="task-priority">Prioridad</label>
                                    <select id="task-priority">
                                        <option value="baja">ğŸŸ¢ Baja</option>
                                        <option value="media" selected>ğŸŸ¡ Media</option>
                                        <option value="alta">ğŸ”´ Alta</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">
                                    ğŸ’¾ Guardar Tarea
                                </button>
                                <button type="button" id="cancel-edit" class="btn btn-secondary" style="display: none;">
                                    âŒ Cancelar
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- EstadÃ­sticas RÃ¡pidas -->
                    <div class="stats-container card">
                        <h3>ğŸ“ˆ EstadÃ­sticas</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value" id="total-tasks">0</div>
                                <div class="stat-label">Total Tareas</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="completed-tasks">0</div>
                                <div class="stat-label">Completadas</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="pending-tasks">0</div>
                                <div class="stat-label">Pendientes</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="high-priority">0</div>
                                <div class="stat-label">Alta Prioridad</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lista de Tareas -->
                <div class="tasks-container card">
                    <div class="section-toolbar">
                        <h3>ğŸ“‹ Lista de Tareas</h3>
                        <div class="filter-controls">
                            <select id="filter-priority" class="filter-select">
                                <option value="">Todas las prioridades</option>
                                <option value="alta">ğŸ”´ Alta</option>
                                <option value="media">ğŸŸ¡ Media</option>
                                <option value="baja">ğŸŸ¢ Baja</option>
                            </select>
                            <select id="filter-status" class="filter-select">
                                <option value="">Todas las tareas</option>
                                <option value="pending">â³ Pendientes</option>
                                <option value="completed">âœ… Completadas</option>
                            </select>
                        </div>
                    </div>
                    <div id="tasks-list" class="tasks-list">
                        <div class="empty-state">
                            <p>No hay tareas. Â¡Crea tu primera tarea!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== SECCIÃ“N CATEGORÃAS MEJORADA ========== -->
            <section id="section-categories" class="content-section">
                <div class="section-header">
                    <h2>ğŸ·ï¸ GestiÃ³n de CategorÃ­as</h2>
                    <p>Administra tus categorÃ­as con contadores automÃ¡ticos vÃ­a triggers</p>
                </div>

                <div class="content-grid">
                    <!-- Formulario CategorÃ­as -->
                    <div class="form-container card">
                        <form id="category-form" class="category-form">
                            <h3>â• Nueva CategorÃ­a</h3>
                            <div class="form-group">
                                <label for="category-name">Nombre de CategorÃ­a *</label>
                                <input type="text" id="category-name" placeholder="Ej: Trabajo, Personal, Estudio..." required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                ğŸ’¾ Crear CategorÃ­a
                            </button>
                        </form>
                    </div>

                    <!-- Info de Triggers -->
                    <div class="info-card card">
                        <h4>ğŸ”” Trigger Activo</h4>
                        <p><code>trg_tasks_after_insert/update/delete</code></p>
                        <p class="info-text">Los contadores se actualizan automÃ¡ticamente cuando:</p>
                        <ul class="info-list">
                            <li>âœ… Creas una tarea en una categorÃ­a</li>
                            <li>âœ… Eliminas una tarea de una categorÃ­a</li>
                            <li>âœ… Cambias la categorÃ­a de una tarea</li>
                        </ul>
                    </div>
                </div>

                <!-- Lista de CategorÃ­as -->
                <div class="categories-container card">
                    <h3>ğŸ“‚ CategorÃ­as Existentes</h3>
                    <div id="categories-list" class="categories-list">
                        <div class="empty-state">
                            <p>No hay categorÃ­as. Â¡Crea la primera!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== SECCIÃ“N AUDITORÃA MEJORADA ========== -->
            <section id="section-audit" class="content-section">
                <div class="section-header">
                    <h2>ğŸ“Š Log de AuditorÃ­a</h2>
                    <p>Registro automÃ¡tico de todas las operaciones mediante triggers</p>
                </div>

                <div class="content-grid">
                    <div class="info-card card">
                        <h4>ğŸ”” Triggers Activos</h4>
                        <div class="triggers-list">
                            <div class="trigger-item">
                                <code>trg_tasks_after_insert</code>
                                <span>Registra creaciÃ³n y actualiza contadores</span>
                            </div>
                            <div class="trigger-item">
                                <code>trg_tasks_after_update</code>
                                <span>Detecta tareas completadas</span>
                            </div>
                            <div class="trigger-item">
                                <code>trg_tasks_after_delete</code>
                                <span>Actualiza contadores al eliminar</span>
                            </div>
                        </div>
                    </div>

                    <div class="audit-stats card">
                        <h4>ğŸ“ˆ Actividad Reciente</h4>
                        <div class="activity-stats">
                            <div class="activity-item">
                                <span class="activity-count" id="insert-count">0</span>
                                <span class="activity-label">Inserciones</span>
                            </div>
                            <div class="activity-item">
                                <span class="activity-count" id="update-count">0</span>
                                <span class="activity-label">Actualizaciones</span>
                            </div>
                            <div class="activity-item">
                                <span class="activity-count" id="delete-count">0</span>
                                <span class="activity-label">Eliminaciones</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Log de AuditorÃ­a -->
                <div class="audit-container card">
                    <div class="section-toolbar">
                        <h3>ğŸ“ Historial de Operaciones</h3>
                        <button id="refresh-audit" class="btn btn-secondary btn-small">
                            ğŸ”„ Actualizar
                        </button>
                    </div>
                    <div id="audit-log" class="audit-log">
                        <div class="empty-state">
                            <p>No hay registros de auditorÃ­a aÃºn</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== SECCIÃ“N DEMO SQL MEJORADA ========== -->
            <section id="section-demo" class="content-section">
                <div class="section-header">
                    <h2>âš¡ DemostraciÃ³n SQL Avanzado</h2>
                    <p>Transacciones, ROLLBACK y operaciones complejas en MySQL</p>
                </div>

                <div class="demo-grid">
                    <div class="demo-card card">
                        <h4>ğŸ”„ TransacciÃ³n con ROLLBACK</h4>
                        <p class="demo-description">
                            Elimina una categorÃ­a y todas sus tareas en una transacciÃ³n atÃ³mica.
                            Si algo falla, se ejecuta ROLLBACK automÃ¡ticamente.
                        </p>
                        
                        <div class="form-group">
                            <label for="demo-category">Seleccionar CategorÃ­a:</label>
                            <select id="demo-category">
                                <option value="">-- Seleccionar --</option>
                            </select>
                        </div>

                        <button id="demo-transaction" class="btn btn-warning">
                            ğŸš€ Ejecutar TransacciÃ³n
                        </button>

                        <div id="demo-result" class="demo-result">
                            <!-- Resultado de la transacciÃ³n -->
                        </div>
                    </div>

                    <div class="demo-card card">
                        <h4>ğŸ“š Conceptos Demostrados</h4>
                        <ul class="concept-list">
                            <li class="concept-item">
                                <span class="concept-icon">âœ…</span>
                                <div>
                                    <strong>CRUD Completo</strong>
                                    <span>Create, Read, Update, Delete</span>
                                </div>
                            </li>
                            <li class="concept-item">
                                <span class="concept-icon">ğŸ””</span>
                                <div>
                                    <strong>Triggers AutomÃ¡ticos</strong>
                                    <span>LÃ³gica de BD automÃ¡tica</span>
                                </div>
                            </li>
                            <li class="concept-item">
                                <span class="concept-icon">ğŸ”„</span>
                                <div>
                                    <strong>Transacciones</strong>
                                    <span>START, COMMIT, ROLLBACK</span>
                                </div>
                            </li>
                            <li class="concept-item">
                                <span class="concept-icon">ğŸ”—</span>
                                <div>
                                    <strong>Foreign Keys</strong>
                                    <span>Integridad referencial</span>
                                </div>
                            </li>
                            <li class="concept-item">
                                <span class="concept-icon">âš¡</span>
                                <div>
                                    <strong>Ãndices Optimizados</strong>
                                    <span>Mejor rendimiento</span>
                                </div>
                            </li>
                            <li class="concept-item">
                                <span class="concept-icon">ğŸ”Œ</span>
                                <div>
                                    <strong>Pool de Conexiones</strong>
                                    <span>Conexiones eficientes</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="demo-card card">
                        <h4>ğŸ” InformaciÃ³n de MySQL</h4>
                        <div class="mysql-info">
                            <div class="info-row">
                                <span class="info-label">Host:</span>
                                <span class="info-value" id="mysql-host">localhost</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Base de datos:</span>
                                <span class="info-value" id="mysql-database">organizador_tareas</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Tablas:</span>
                                <span class="info-value" id="mysql-tables">3</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Triggers:</span>
                                <span class="info-value" id="mysql-triggers">3</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">ConexiÃ³n:</span>
                                <span class="info-value" id="mysql-connection">Activa</span>
                            </div>
                        </div>
                        <button id="test-connection" class="btn btn-secondary btn-small">
                            ğŸ” Probar ConexiÃ³n
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Console Panel Mejorado -->
        <aside class="console-panel">
            <div class="console-header">
                <div class="console-title">
                    <h4>ğŸ–¥ï¸ Consola MySQL</h4>
                    <span class="console-subtitle">Operaciones en tiempo real</span>
                </div>
                <div class="console-controls">
                    <button id="clear-console" class="btn-console">ğŸ—‘ï¸</button>
                    <button id="toggle-console" class="btn-console">ğŸ“‹</button>
                </div>
            </div>
            <div id="console-output" class="console-output">
                <div class="console-entry system">
                    <span class="timestamp">[00:00:00]</span>
                    <span class="message">ğŸš€ Sistema iniciado. Conectando a MySQL...</span>
                </div>
            </div>
            <div class="console-footer">
                <div class="connection-status" id="console-status">
                    <div class="status-dot connecting"></div>
                    <span>Conectando a MySQL...</span>
                </div>
            </div>
        </aside>
    </div>

    <!-- Sistema de Notificaciones Toast -->
    <div class="toast-container" id="toast-container"></div>

    <!-- BotÃ³n Dark Mode -->
    <div class="theme-toggle">
        <button class="toggle-btn" id="theme-toggle" title="Cambiar tema"></button>
    </div>

    <script src="renderer.js"></script>
</body>
</html>