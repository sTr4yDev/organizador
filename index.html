<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizador de Tareas - Electron + MySQL</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar Moderno -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>üìã Organizador</h1>
                <p class="sidebar-subtitle">Electron + MySQL</p>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-section="tasks">
                    <span class="nav-icon">üìù</span>
                    <span class="nav-text">Tareas</span>
                    <span class="nav-badge" id="tasks-count">0</span>
                </button>
                
                <button class="nav-item" data-section="categories">
                    <span class="nav-icon">üè∑Ô∏è</span>
                    <span class="nav-text">Categor√≠as</span>
                    <span class="nav-badge" id="categories-count">0</span>
                </button>
                
                <button class="nav-item" data-section="audit">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">Auditor√≠a</span>
                    <span class="nav-badge" id="audit-count">0</span>
                </button>
                
                <button class="nav-item" data-section="demo">
                    <span class="nav-icon">‚ö°</span>
                    <span class="nav-text">Demo SQL</span>
                </button>
            </nav>

            <!-- DB Status en sidebar -->
            <div class="sidebar-footer">
                <div id="db-status-sidebar" class="db-status">
                    <span class="status-dot connecting"></span>
                    <span class="status-text">Conectando a MySQL...</span>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-area">
            <!-- Header compacto -->
            <header class="page-header">
                <div class="header-content">
                    <h2 id="page-title">Gesti√≥n de Tareas</h2>
                    <button id="theme-toggle-btn" class="icon-btn" title="Cambiar tema">üåô</button>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="page-content">
                <!-- ========== SECCI√ìN TAREAS ========== -->
                <section id="section-tasks" class="content-section active">
                    <div class="section-header">
                        <h2>üéØ Gesti√≥n de Tareas</h2>
                        <p>CRUD completo con triggers autom√°ticos en MySQL</p>
                    </div>

                    <div class="content-grid">
                        <!-- Formulario Tareas -->
                        <div class="form-container">
                            <form id="task-form" class="task-form">
                                <h3 id="form-title">‚ûï Nueva Tarea</h3>
                                <input type="hidden" id="task-id">
                                
                                <div class="form-group">
                                    <label for="task-title">T√≠tulo *</label>
                                    <input type="text" id="task-title" placeholder="¬øQu√© necesitas hacer?" required>
                                </div>

                                <div class="form-group">
                                    <label for="task-description">Descripci√≥n</label>
                                    <textarea id="task-description" placeholder="Detalles de la tarea..." rows="3"></textarea>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="task-category">Categor√≠a</label>
                                        <select id="task-category">
                                            <option value="">Sin categor√≠a</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="task-priority">Prioridad</label>
                                        <select id="task-priority">
                                            <option value="baja">üü¢ Baja</option>
                                            <option value="media" selected>üü° Media</option>
                                            <option value="alta">üî¥ Alta</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        üíæ Guardar Tarea
                                    </button>
                                    <button type="button" id="cancel-edit" class="btn btn-secondary" style="display: none;">
                                        ‚ùå Cancelar
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Estad√≠sticas R√°pidas -->
                        <div class="stats-container">
                            <h3>üìà Estad√≠sticas</h3>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="total-tasks">0</div>
                                    <div class="stat-label">Total Tareas</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="completed-tasks">0</div>
                                    <div class="stat-label">Completadas</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="pending-tasks">0</div>
                                    <div class="stat-label">Pendientes</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="high-priority">0</div>
                                    <div class="stat-label">Alta Prioridad</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Lista de Tareas -->
                    <div class="tasks-container">
                        <div class="section-toolbar">
                            <h3>üìã Lista de Tareas</h3>
                            <div class="filter-controls">
                                <select id="filter-priority" class="filter-select">
                                    <option value="">Todas las prioridades</option>
                                    <option value="alta">üî¥ Alta</option>
                                    <option value="media">üü° Media</option>
                                    <option value="baja">üü¢ Baja</option>
                                </select>
                                <select id="filter-status" class="filter-select">
                                    <option value="">Todas las tareas</option>
                                    <option value="pending">‚è≥ Pendientes</option>
                                    <option value="completed">‚úÖ Completadas</option>
                                </select>
                            </div>
                        </div>
                        <div id="tasks-list" class="tasks-list">
                            <div class="empty-state">
                                <p>No hay tareas. ¬°Crea tu primera tarea!</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ========== SECCI√ìN CATEGOR√çAS ========== -->
                <section id="section-categories" class="content-section">
                    <div class="section-header">
                        <h2>üè∑Ô∏è Gesti√≥n de Categor√≠as</h2>
                        <p>Administra tus categor√≠as con contadores autom√°ticos v√≠a triggers</p>
                    </div>

                    <div class="content-grid">
                        <!-- Formulario Categor√≠as -->
                        <div class="form-container">
                            <form id="category-form" class="category-form">
                                <h3>‚ûï Nueva Categor√≠a</h3>
                                <div class="form-group">
                                    <label for="category-name">Nombre de Categor√≠a *</label>
                                    <input type="text" id="category-name" placeholder="Ej: Trabajo, Personal, Estudio..." required>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                    üíæ Crear Categor√≠a
                                </button>
                            </form>
                        </div>

                        <!-- Info de Triggers -->
                        <div class="info-card">
                            <h4>üîî Trigger Activo</h4>
                            <p><code>trg_tasks_after_insert/update/delete</code></p>
                            <p class="info-text">Los contadores se actualizan autom√°ticamente cuando:</p>
                            <ul class="info-list">
                                <li>‚úÖ Creas una tarea en una categor√≠a</li>
                                <li>‚úÖ Eliminas una tarea de una categor√≠a</li>
                                <li>‚úÖ Cambias la categor√≠a de una tarea</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Lista de Categor√≠as -->
                    <div class="categories-container">
                        <h3>üìÇ Categor√≠as Existentes</h3>
                        <div id="categories-list" class="categories-list">
                            <div class="empty-state">
                                <p>No hay categor√≠as. ¬°Crea la primera!</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ========== SECCI√ìN AUDITOR√çA ========== -->
                <section id="section-audit" class="content-section">
                    <div class="section-header">
                        <h2>üìä Log de Auditor√≠a</h2>
                        <p>Registro autom√°tico de todas las operaciones mediante triggers</p>
                    </div>

                    <div class="content-grid">
                        <div class="info-card">
                            <h4>üîî Triggers Activos</h4>
                            <div class="triggers-list">
                                <div class="trigger-item">
                                    <code>trg_tasks_after_insert</code>
                                    <span>Registra creaci√≥n y actualiza contadores</span>
                                </div>
                                <div class="trigger-item">
                                    <code>trg_tasks_after_update</code>
                                    <span>Detecta tareas completadas</span>
                                </div>
                                <div class="trigger-item">
                                    <code>trg_tasks_after_delete</code>
                                    <span>Actualiza contadores al eliminar</span>
                                </div>
                            </div>
                        </div>

                        <div class="audit-stats">
                            <h4>üìà Actividad Reciente</h4>
                            <div class="activity-stats">
                                <div class="activity-item">
                                    <span class="activity-count" id="insert-count">0</span>
                                    <span class="activity-label">Inserciones</span>
                                </div>
                                <div class="activity-item">
                                    <span class="activity-count" id="update-count">0</span>
                                    <span class="activity-label">Actualizaciones</span>
                                </div>
                                <div class="activity-item">
                                    <span class="activity-count" id="delete-count">0</span>
                                    <span class="activity-label">Eliminaciones</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Log de Auditor√≠a -->
                    <div class="audit-container">
                        <div class="section-toolbar">
                            <h3>üìù Historial de Operaciones</h3>
                            <button id="refresh-audit" class="btn btn-secondary btn-small">
                                üîÑ Actualizar
                            </button>
                        </div>
                        <div id="audit-log" class="audit-log">
                            <div class="empty-state">
                                <p>No hay registros de auditor√≠a a√∫n</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ========== SECCI√ìN DEMO SQL ========== -->
                <section id="section-demo" class="content-section">
                    <div class="section-header">
                        <h2>‚ö° Demostraci√≥n SQL Avanzado</h2>
                        <p>Transacciones, ROLLBACK y operaciones complejas en MySQL</p>
                    </div>

                    <div class="demo-grid">
                        <div class="demo-card">
                            <h4>üîÑ Transacci√≥n con ROLLBACK</h4>
                            <p class="demo-description">
                                Elimina una categor√≠a y todas sus tareas en una transacci√≥n at√≥mica.
                                Si algo falla, se ejecuta ROLLBACK autom√°ticamente.
                            </p>
                            
                            <div class="form-group">
                                <label for="demo-category">Seleccionar Categor√≠a:</label>
                                <select id="demo-category">
                                    <option value="">-- Seleccionar --</option>
                                </select>
                            </div>

                            <button id="demo-transaction" class="btn btn-warning">
                                üöÄ Ejecutar Transacci√≥n
                            </button>

                            <div id="demo-result" class="demo-result">
                                <!-- Resultado de la transacci√≥n -->
                            </div>
                        </div>

                        <div class="demo-card">
                            <h4>üìö Conceptos Demostrados</h4>
                            <ul class="concept-list">
                                <li class="concept-item">
                                    <span class="concept-icon">‚úÖ</span>
                                    <div>
                                        <strong>CRUD Completo</strong>
                                        <span>Create, Read, Update, Delete</span>
                                    </div>
                                </li>
                                <li class="concept-item">
                                    <span class="concept-icon">üîî</span>
                                    <div>
                                        <strong>Triggers Autom√°ticos</strong>
                                        <span>L√≥gica de BD autom√°tica</span>
                                    </div>
                                </li>
                                <li class="concept-item">
                                    <span class="concept-icon">üîÑ</span>
                                    <div>
                                        <strong>Transacciones</strong>
                                        <span>START, COMMIT, ROLLBACK</span>
                                    </div>
                                </li>
                                <li class="concept-item">
                                    <span class="concept-icon">üîó</span>
                                    <div>
                                        <strong>Foreign Keys</strong>
                                        <span>Integridad referencial</span>
                                    </div>
                                </li>
                                <li class="concept-item">
                                    <span class="concept-icon">‚ö°</span>
                                    <div>
                                        <strong>√çndices Optimizados</strong>
                                        <span>Mejor rendimiento</span>
                                    </div>
                                </li>
                                <li class="concept-item">
                                    <span class="concept-icon">üîå</span>
                                    <div>
                                        <strong>Pool de Conexiones</strong>
                                        <span>Conexiones eficientes</span>
                                    </div>
                                </li>
                            </ul>
                        </div>

                        <div class="demo-card">
                            <h4>üîç Informaci√≥n de MySQL</h4>
                            <div class="mysql-info">
                                <div class="info-row">
                                    <span class="info-label">Host:</span>
                                    <span class="info-value" id="mysql-host">localhost</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Base de datos:</span>
                                    <span class="info-value" id="mysql-database">organizador_tareas</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Tablas:</span>
                                    <span class="info-value" id="mysql-tables">3</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Triggers:</span>
                                    <span class="info-value" id="mysql-triggers">3</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Conexi√≥n:</span>
                                    <span class="info-value" id="mysql-connection">Activa</span>
                                </div>
                            </div>
                            <button id="test-connection" class="btn btn-secondary btn-small">
                                üîç Probar Conexi√≥n
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Console Panel Colapsable -->
        <div class="console-container collapsed">
            <div class="console-header">
                <h4>üñ•Ô∏è Consola MySQL</h4>
                <div class="console-controls">
                    <button id="clear-console" class="console-toggle" title="Limpiar consola">üóëÔ∏è</button>
                    <button id="console-toggle-btn" class="console-toggle" title="Minimizar/Maximizar">üìã</button>
                </div>
            </div>
            <div class="console-panel">
                <div id="console-output" class="console-output">
                    <div class="console-entry system">
                        <span class="timestamp">[00:00:00]</span>
                        <span class="message">üöÄ Sistema iniciado. Conectando a MySQL...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sistema de Notificaciones Toast -->
    <div class="toast-container" id="toast-container"></div>

    <script src="renderer.js"></script>
</body>
</html>